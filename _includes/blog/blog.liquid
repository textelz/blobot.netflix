<div class="posts" data-testid="blog-posts">
    {% assign all_posts = '' | split: '' %}
    {% comment %} 먼저 _posts의 모든 파일 포함 (하위 폴더 포함) {% endcomment %}
    {% if site.posts and site.posts.size > 0 %}
        {% assign all_posts = site.posts %}
    {% endif %}
    {% comment %} 그 다음 컬렉션들 추가 {% endcomment %}
    {% for collection in site.collections %}
        {% unless collection.label == 'posts' or collection.label == 'data' or collection.label == 'portfolio' %}
            {% assign collection_docs = site[collection.label] %}
            {% if collection_docs and collection_docs.size > 0 %}
                {% if all_posts.size > 0 %}
                    {% assign all_posts = all_posts | concat: collection_docs %}
                {% else %}
                    {% assign all_posts = collection_docs %}
                {% endif %}
            {% endif %}
        {% endunless %}
    {% endfor %}
    {% assign all_posts = all_posts | sort: 'date' | reverse %}
    {% assign per_page = paginator.per_page | default: site.paginate | default: 5 %}
    {% if per_page > 0 %}
        {% assign start_index = paginator.page | minus: 1 | times: per_page %}
        {% assign end_index = start_index | plus: per_page | minus: 1 %}
        {% assign paginated_posts = all_posts | slice: start_index, per_page %}
    {% else %}
        {% assign paginated_posts = all_posts %}
    {% endif %}
    {% unless paginated_posts.size > 0 %}
    <article><section class="post-content"><p>There are no blog posts</p></section></article>
    {% endunless %}
    {% for post in paginated_posts %}
    <div class="post-teaser" data-testid="blog-post-teaser">
        {% if post.thumbnail %}
        <div class="post-img">
            <a aria-label="{{ post.title }}" href="{{ post.url | relative_url }}">
                <img alt="{{ post.title }}" src="{{ post.thumbnail | relative_url }}">
            </a>
        </div>
        {% endif %}
        <span>
          <header>
            <h1>
              <a aria-label="{{ post.title }}" class="post-link" data-testid="blog-post-link" href="{{ post.url | relative_url }}">
                {{ post.title }}
              </a>
            </h1>
            {% include blog/post_info.liquid author=post.author date=post.date %}
          </header>
          {% if site.excerpt or site.theme_settings.excerpt %}
              <div class="excerpt">
                  {% if site.excerpt == "truncate" %}
                     {{ post.content | strip_html | truncate: '250' | escape }}
                  {% else %}
                     {{ post.excerpt | strip_html | escape }}
                  {% endif %}
              </div>
          {% endif %}
      </span>
    </div>
    {% endfor %}
</div>

{% include blog/blog_nav.liquid %}
